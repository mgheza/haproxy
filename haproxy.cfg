#---------------------------------------------------------------------
# Example configuration for a possible web application.  See the
# full configuration options online.
#
#   https://www.haproxy.org/download/1.8/doc/configuration.txt
#
#---------------------------------------------------------------------

#---------------------------------------------------------------------
# Global settings
#---------------------------------------------------------------------
global
    # to have these messages end up in /var/log/haproxy.log you will
    # need to:
    #
    # 1) configure syslog to accept network log events.  This is done
    #    by adding the '-r' option to the SYSLOGD_OPTIONS in
    #    /etc/sysconfig/syslog
    #
    # 2) configure local2 events to go to the /var/log/haproxy.log
    #   file. A line like the following can be added to
    #   /etc/sysconfig/syslog
    #
    #    local2.*                       /var/log/haproxy.log
    #
    log         127.0.0.1 local2

    chroot      /var/lib/haproxy
    pidfile     /var/run/haproxy.pid
    maxconn     5000
    user        haproxy
    group       haproxy
    daemon

    # turn on stats unix socket
    stats socket /var/lib/haproxy/stats

    # utilize system-wide crypto-policies
    ssl-default-bind-options ssl-min-ver TLSv1.2
    ssl-default-bind-ciphers PROFILE=SYSTEM
    ssl-default-server-ciphers PROFILE=SYSTEM

    nbproc      2
    cpu-map     1 0
    cpu-map     2 1
    stats bind-process  2

#---------------------------------------------------------------------
# common defaults that all the 'listen' and 'backend' sections will
# use if not designated in their block
#---------------------------------------------------------------------
defaults
    mode                    http
    log                     global
    option                  httplog
    option                  dontlognull
    option http-server-close
    option forwardfor       except 127.0.0.0/8
    option                  redispatch
    retries                 3
    timeout http-request    60s
    timeout queue           90m
    timeout connect         60s
    timeout client          90m
    timeout server          90m
    timeout http-keep-alive 10s
    timeout check           60s
    maxconn                 5000

#---------------------------------------------------------------------
# main frontend which proxys to the backends
#---------------------------------------------------------------------
frontend http_default
    bind        192.168.5.25:80
    bind        192.168.5.25:443 ssl crt /etc/haproxy/ssl/ivf2/
    option      http-server-close
    option      forwardfor
    stats       uri /statistiche-haproxy
    stats enable
    stats auth invisiblefarm:Vantini1! 

    #Direttive peer challenge durante emissione o rinnovo certificati Letsencrypt
    acl letsencrypt-acl path_beg /.well-known/acme-challenge/
    use_backend letsencrypt-standalone if letsencrypt-acl

    acl host_rmi  hdr(host)  -i rmi.sivian.it
    redirect scheme https if host_rmi !{ ssl_fc }
    use_backend  docker01_rmi  if  host_rmi
   
    acl host_rmi_test hdr(host) -i rmi-test.invisiblefarm.it
    redirect scheme https if host_rmi_test !{ ssl_fc }
    use_backend  docker12_rmi  if host_rmi_test
 
    acl host_botcommander hdr(host) -i botcommander.invisiblefarm.it
    redirect scheme https if host_botcommander !{ ssl_fc }
    use_backend docker17_botcommander if host_botcommander

    acl host_infobot hdr(host) -i infobot.invisiblefarm.it
    redirect scheme https if host_infobot !{ ssl_fc }
    use_backend docker17_infobot if host_infobot


    acl host_connectorfarm hdr(host) -i connectorfarm.invisiblefarm.it
    redirect scheme https if host_connectorfarm !{ ssl_fc }
    use_backend docker17_connectorfarm if host_connectorfarm
    
    acl host_apibdn hdr(host) -i apibdn.invisiblefarm.it
    redirect scheme https if host_apibdn !{ ssl_fc }
    use_backend docker17_apibdn if host_apibdn

    acl host_sentinelfarm_web hdr(host) -i sentinelfarm.invisiblefarm.it
    redirect scheme https if host_sentinelfarm_web !{ ssl_fc }
    use_backend docker17_sentinelfarm_web if host_sentinelfarm_web    

    acl host_sentinelfarm_api hdr(host) -i api-sentinelfarm.invisiblefarm.it
    redirect scheme https if host_sentinelfarm_api !{ ssl_fc }
    use_backend docker17_sentinelfarm_api if host_sentinelfarm_api
    
    acl host_docker18_sigla4_izsler hdr(host) -i sigla4-izsler.invisiblefarm.it
    redirect scheme https if host_docker18_sigla4_izsler !{ ssl_fc }
    use_backend docker18_sigla4_izsler if host_docker18_sigla4_izsler 

    acl host_docker18_sigla5_izsler hdr(host) -i sigla-izsler.invisiblefarm.it
    redirect scheme https if host_docker18_sigla5_izsler !{ ssl_fc }
    use_backend docker18_sigla5_izsler if host_docker18_sigla5_izsler 

    acl host_docker18_sigla_izsum hdr(host) -i sigla-izsum.invisiblefarm.it
    redirect scheme https if host_docker18_sigla_izsum !{ ssl_fc }
    use_backend docker18_sigla_izsum if host_docker18_sigla_izsum
    
    acl host_docker18_sigla_lab hdr(host) -i sigla-lab.invisiblefarm.it
    redirect scheme https if host_docker18_sigla_lab !{ ssl_fc }
    use_backend docker18_sigla_lab if host_docker18_sigla_lab

    acl host_docker19_api hdr(host) -i api.invisiblefarm.it
    redirect scheme https if host_docker19_api !{ ssl_fc }
    use_backend docker19_api if host_docker19_api

    acl host_docker19_acquebresciane hdr(host) -i www.acquebresciane.it
    redirect scheme https if host_docker19_acquebresciane !{ ssl_fc }
    use_backend docker19_acquebresciane if host_docker19_acquebresciane

    acl host_docker19_acquebresciane_redirect hdr(host) -i acquebresciane.it
    redirect scheme https if host_docker19_acquebresciane_redirect !{ ssl_fc }
    use_backend docker19_acquebresciane if host_docker19_acquebresciane_redirect


    acl host_docker19_cdg hdr(host) -i budget.irccs-sangerardo.it
    redirect scheme https if host_docker19_cdg !{ ssl_fc }
    use_backend docker19_cdg if host_docker19_cdg

    acl host_docker21_test_santionibus_antonio hdr(host) -i santionibus-test.sanita.marche.it
    redirect scheme https if host_docker21_test_santionibus_antonio !{ ssl_fc }
    use_backend docker21_test_santionibus_antonio if host_docker21_test_santionibus_antonio

    acl host_docker23_santionibus hdr(host) -i santionibus.sanita.marche.it
    redirect scheme https if host_docker23_santionibus !{ ssl_fc }
    use_backend docker23_santionibus if host_docker23_santionibus

    acl host_docker24_passbolt hdr(host) -i pass.invisiblefarm.it
    redirect scheme https if host_docker24_passbolt !{ ssl_fc }
    use_backend docker24_passbolt if host_docker24_passbolt

    acl host_docker24_pinfoa_test hdr(host) -i test-pinfoa.invisiblefarm.it
    redirect scheme https if host_docker24_pinfoa_test !{ ssl_fc }
    use_backend docker24_pinfoa_test if host_docker24_pinfoa_test

    acl host_docker24_samltest hdr(host) -i mmg-idpc-test.invisiblefarm.it
    redirect scheme https if host_docker24_samltest !{ ssl_fc }
    use_backend docker24_samltest if host_docker24_samltest

    acl host_docker24_samlprod hdr(host) -i mmg-idpc.invisiblefarm.it
    redirect scheme https if host_docker24_samlprod !{ ssl_fc }
    use_backend docker24_samlprod if host_docker24_samlprod

    acl host_docker20_prod_santionibus_milano hdr(host) -i santionibus-mi.invisiblefarm.it
    redirect scheme https if host_docker20_prod_santionibus_milano !{ ssl_fc }
    use_backend docker20_prod_santionibus_milano if host_docker20_prod_santionibus_milano
    
    acl host_docker20_prod_api_santionibus_milano hdr(host) -i api-santionibus-mi.invisiblefarm.it
    redirect scheme https if host_docker20_prod_api_santionibus_milano !{ ssl_fc }
    use_backend docker20_prod_api_santionibus_milano if host_docker20_prod_api_santionibus_milano

    acl host_docker21_test_santionibus_milano hdr(host) -i test-santionibus-mi.invisiblefarm.it
    redirect scheme https if host_docker21_test_santionibus_milano !{ ssl_fc }
    use_backend docker21_test_santionibus_milano if host_docker21_test_santionibus_milano

    acl host_docker21_test_api_santionibus_milano hdr(host) -i test-api-santionibus-mi.invisiblefarm.it
    redirect scheme https if host_docker21_test_api_santionibus_milano !{ ssl_fc }
    use_backend docker21_test_api_santionibus_milano if host_docker21_test_api_santionibus_milano
    
    acl host_docker21_test_billing hdr(host) -i billing-test.sanita.marche.it
    redirect scheme https if host_docker21_test_billing !{ ssl_fc }
    use_backend docker21_test_billing if host_docker21_test_billing

    acl host_docker23_billing hdr(host) -i billing.sanita.marche.it
    redirect scheme https if host_docker23_billing !{ ssl_fc }
    use_backend docker23_billing if host_docker23_billing

    acl host_docker20_devops hdr(host) -i devops.invisiblefarm.it
    redirect scheme https if host_docker20_devops !{ ssl_fc }
    use_backend docker20_devops if host_docker20_devops

    acl host_docker22_polis hdr(host) -i mmg-polis.invisiblefarm.it
    redirect scheme https if host_docker22_polis !{ ssl_fc }
    use_backend docker22_polis if host_docker22_polis

    acl host_docker22_polis_prod hdr(host) -i gestionecorsimmg.servizirl.it
    redirect scheme https if host_docker22_polis_prod !{ ssl_fc }
    use_backend docker22_polis_prod if host_docker22_polis_prod

    acl host_docker22_polis_test hdr(host) -i mmg-polis-test.invisiblefarm.it
    redirect scheme https if host_docker22_polis_test !{ ssl_fc }
    use_backend docker22_polis if host_docker22_polis_test
    
    acl host_snowapp_test hdr(host) -i test-bo.skipasslombardia.it
    redirect scheme https if host_snowapp_test !{ ssl_fc }
    use_backend snowapp_azure_test if host_snowapp_test

    acl host_snowapp_prod hdr(host) -i bo.skipasslombardia.it
    redirect scheme https if host_snowapp_prod !{ ssl_fc }
    use_backend snowapp_azure_prod if host_snowapp_prod
    
    acl host_snowapp_azure_web_prod hdr(host) -i ppu.skipasslombardia.it
    redirect scheme https if host_snowapp_azure_web_prod !{ ssl_fc }
    use_backend snowapp_azure_web_prod if host_snowapp_azure_web_prod

    acl host_snowapp_azure_web_test hdr(host) -i test-ppu.skipasslombardia.it
    redirect scheme https if host_snowapp_azure_web_test !{ ssl_fc }
    use_backend snowapp_azure_web_test if host_snowapp_azure_web_test

    acl host_snowapp_azure_wa_prod hdr(host) -i ppu-api.skipasslombardia.it
    redirect scheme https if host_snowapp_azure_wa_prod !{ ssl_fc }
    use_backend snowapp_azure_wa_prod if host_snowapp_azure_wa_prod

    acl host_snowapp_azure_wa_test hdr(host) -i test-ppu-api.skipasslombardia.it
    redirect scheme https if host_snowapp_azure_wa_test !{ ssl_fc }
    use_backend snowapp_azure_wa_test if host_snowapp_azure_wa_test


    acl host_signer_rmi  hdr(host)  -i signer-rmi.invisiblefarm.it
    use_backend  docker01_signer_rmi  if  host_signer_rmi

    acl host_www_sivian_it  hdr(host)  -i www.sivian.it
    use_backend  docker02_www_sivian_it  if  host_www_sivian_it

    acl host_www_vetinweb_it  hdr(host)  -i www.vetinweb.it
    use_backend  docker02_www_vetinweb_it  if  host_www_vetinweb_it

    acl host_art316-mi  hdr(host)  -i art316-mi.invisiblefarm.it
    use_backend  docker02_art316-mi  if  host_art316-mi

    acl host_art316-mi-test  hdr(host)  -i test-art316-mi.invisiblefarm.it
    use_backend  docker02_art316-mi  if  host_art316-mi-test

    acl host_api-art316-mi  hdr(host)  -i api-art316-mi.invisiblefarm.it
    use_backend  docker02_api-art316-mi  if  host_api-art316-mi

    acl host_test-api-art316-mi  hdr(host)  -i test-api-art316-mi.invisiblefarm.it
    use_backend  docker02_api-art316-mi  if  host_test-api-art316-mi

    acl host_verbali_sivian_it  hdr(host)  -i verbali.sivian.it
    redirect scheme https if host_verbali_sivian_it !{ ssl_fc  }
    use_backend  docker02_verbali_sivian_it  if  host_verbali_sivian_it

    acl host_bg_sivian_it  hdr(host)  -i bg.sivian.it
    redirect scheme https if host_bg_sivian_it !{ ssl_fc }
    use_backend  podman02_bg_sivian_it  if  host_bg_sivian_it

    acl host_bs_sivian_it  hdr(host)  -i bs.sivian.it
    redirect scheme https if host_bs_sivian_it !{ ssl_fc  }
    use_backend  podman02_bs_sivian_it  if  host_bs_sivian_it

    acl host_mb_sivian_it  hdr(host)  -i mb.sivian.it
    redirect scheme https if host_mb_sivian_it !{ ssl_fc  }
    use_backend  podman02_mb_sivian_it  if  host_mb_sivian_it

    acl host_api_sivian_it  hdr(host)  -i api.sivian.it
    redirect scheme https if host_api_sivian_it !{ ssl_fc  }
    use_backend  podman02_api_sivian_it  if  host_api_sivian_it

    acl host_mi_sivian_it  hdr(host)  -i mi.sivian.it
    redirect scheme https if host_mi_sivian_it !{ ssl_fc }
    use_backend  podman02_mi_sivian_it  if  host_mi_sivian_it

    acl host_va_sivian_it  hdr(host)  -i va.sivian.it
    redirect scheme https if host_va_sivian_it !{ ssl_fc } 
    use_backend  podman02_va_sivian_it  if  host_va_sivian_it
    
    acl host_mo_sivian_it  hdr(host)  -i mo.sivian.it
    redirect scheme https if host_mo_sivian_it !{ ssl_fc } 
    use_backend  podman02_mo_sivian_it  if  host_mo_sivian_it
    
    acl host_pv_sivian_it  hdr(host)  -i pv.sivian.it
    redirect scheme https if host_pv_sivian_it !{ ssl_fc } 
    use_backend  podman02_pv_sivian_it  if  host_pv_sivian_it
      
    acl host_suite2_sivian_it  hdr(host)  -i login.sivian.it
    redirect scheme https if host_suite2_sivian_it !{ ssl_fc }
    use_backend  podman02_suite_sivian_it if  host_suite2_sivian_it
    
    acl host_siv_sivian_it  hdr(host)  -i siv.sivian.it
    redirect scheme https if host_siv_sivian_it !{ ssl_fc }
    use_backend  podman02_siv_sivian_it if  host_siv_sivian_it
 
    acl host_sel_sivian_it  hdr(host)  -i sel.sivian.it
    redirect scheme https if host_sel_sivian_it !{ ssl_fc }
    use_backend  podman02_sel_sivian_it if  host_sel_sivian_it
 

    acl host_cerves_it  hdr(host)  -i cerves.izsler.it
    use_backend  docker02_va_sivian_it  if  host_cerves_it

    acl host_ws_sosscuole  hdr(host)  -i ws-sosscuole.invisiblefarm.it
    use_backend  docker01_ws_sosscuole  if  host_ws_sosscuole

    acl host_mmg_test  hdr(host)  -i mmg-test.invisiblefarm.it
    use_backend  mweb03_mmg_test  if  host_mmg_test

    acl host_mmg_test_api  hdr(host)  -i ws-mmg-test.invisiblefarm.it
    use_backend  mweb03_mmg_test_api  if  host_mmg_test_api

    acl host_cruscotto_sosscuole  hdr(host)  -i cruscotto.sosscuole.it
    redirect scheme https if host_cruscotto_sosscuole !{ ssl_fc }
    use_backend  docker01_cruscotto_sosscuole  if  host_cruscotto_sosscuole

    acl host_ws_pay_hub  hdr(host)  -i ws-payhub.invisiblefarm.it
    use_backend  docker01_ws_pay_hub  if  host_ws_pay_hub

    acl host_portalescuole_db  hdr(host)  -i portalescuoledb.invisiblefarm.it
    redirect scheme https if host_portalescuole_db !{ ssl_fc }
    use_backend  docker09_phpAdmin if  host_portalescuole_db

    acl host_f_cremona  hdr(host)  -i asst-cremona.formazionesanitaria.it
    redirect scheme https if host_f_cremona !{ ssl_fc }
    use_backend  mweb02_cremona  if  host_f_cremona
    
    acl host_formazione_fondazionebssolidale hdr(host) -i formazione.fondazionebssolidale.it
    redirect scheme https if host_formazione_fondazionebssolidale !{ ssl_fc }
    use_backend mweb02_fondazionebssolidale if host_formazione_fondazionebssolidale

    acl host_formazione_apsstn hdr(host) -i fad.apss.tn.it
    redirect scheme https if host_formazione_apsstn !{ ssl_fc }
    use_backend mweb01_apsstn if  host_formazione_apsstn 

    acl host_formazione_old_apsstn hdr(host) -i oldfad.apss.tn.it
    redirect scheme https if host_formazione_old_apsstn !{ ssl_fc }
    use_backend mweb01_old_apsstn if  host_formazione_old_apsstn 

    acl host_dad_apsstn hdr(host) -i dad-polodidattico.apss.tn.it
    redirect scheme https if host_dad_apsstn !{ ssl_fc }
    use_backend mweb01_dad_apsstn if  host_dad_apsstn

    acl host_formazioneindividuale hdr(host) -i formazioneindividuale-aggiornamentoscientifico.apss.tn.it
    redirect scheme https if host_formazioneindividuale !{ ssl_fc }
    use_backend mweb01_apsstn_formazioneindividuale if  host_formazioneindividuale 

    acl host_test_formazione_sanitaria hdr(host) -i test.formazionesanitaria.it
    redirect scheme https if host_test_formazione_sanitaria !{ ssl_fc }
    use_backend mwebtest_test_formazione if host_test_formazione_sanitaria

    acl host_mweb01_fad hdr(host) -i fad.izsum.it
    redirect scheme https if host_mweb01_fad !{ ssl_fc }
    use_backend mweb01_fad if host_mweb01_fad

    acl host_mweb04_gestione_aule_sangerardo hdr(host) -i gestioneaule.irccs-sangerardo.it
    redirect scheme https if host_mweb04_gestione_aule_sangerardo !{ ssl_fc }
    use_backend mweb04_gestione_aule_sangerardo if host_mweb04_gestione_aule_sangerardo

    acl host_c_cremona  hdr(host)  -i compilazione-cremona.formazionesanitaria.it
    redirect scheme https if host_c_cremona !{ ssl_fc }
    use_backend  mweb02_cremona_compilazione  if  host_c_cremona
    
    acl host_compilazione_izslt  hdr(host)  -i compilazione.izslt.it
    redirect scheme https if host_compilazione_izslt !{ ssl_fc }
    use_backend  mweb04_compilazione_izslt  if  host_compilazione_izslt

    acl host_f_sette_laghi  hdr(host)  -i asst-settelaghi.formazionesanitaria.it
    redirect scheme https if host_f_sette_laghi !{ ssl_fc }
    use_backend  mweb02_sette_laghi  if  host_f_sette_laghi

    acl host_f_izsler  hdr(host)  -i fad.izsler.it
    redirect scheme https if host_f_izsler !{ ssl_fc }
    use_backend  mweb02_izsler  if  host_f_izsler

    acl host_f_sanmatteo  hdr(host)  -i sanmatteo.formazionesanitaria.it
    redirect scheme https if host_f_sanmatteo !{ ssl_fc }
    use_backend  mweb04_sanmatteo  if  host_f_sanmatteo
    
    acl host_f_sangerardo hdr(host) -i fad.irccs-sangerardo.it
    redirect scheme https if host_f_sangerardo !{ ssl_fc }
    use_backend mweb04_sangerardo if host_f_sangerardo
    
    acl host_f_mantova  hdr(host)  -i fad.asst-mantova.it
    redirect scheme https if host_f_mantova !{ ssl_fc }
    use_backend  mweb01_mantova  if  host_f_mantova
    
    acl host_compilazione_mantova  hdr(host)  -i compilazione.asst-mantova.it
    redirect scheme https if host_compilazione_mantova !{ ssl_fc }
    use_backend  mweb01_mantova_compilazione  if  host_compilazione_mantova
  

    acl host_f_test_bergamoest  hdr(host)  -i test-bergamoest.formazionesanitaria.it
    redirect scheme https if host_f_test_bergamoest !{ ssl_fc }
    use_backend  mweb01_test_bergamoest  if  host_f_test_bergamoest

    acl host_test2_formazionesanitaria  hdr(host)  -i test2.formazionesanitaria.it
    redirect scheme https if host_test2_formazionesanitaria !{ ssl_fc }
    use_backend  mweb01_test2_formazionesanitaria  if  host_test2_formazionesanitaria
    
    acl host_f_portici  hdr(host)  -i fad.izsmportici.it
    redirect scheme https if host_f_portici !{ ssl_fc }
    use_backend  mweb03_portici  if  host_f_portici

    acl host_c_portici  hdr(host)  -i compilazione.izsmportici.it
    redirect scheme https if host_c_portici !{ ssl_fc }
    use_backend  mweb03_portici_compilazione  if  host_c_portici

    acl host_f_lecco  hdr(host)  -i asst-lecco.formazionesanitaria.it
    redirect scheme https if host_f_lecco !{ ssl_fc }
    use_backend  mweb03_lecco  if  host_f_lecco

    acl host_c_lecco  hdr(host)  -i compilazione-lecco.formazionesanitaria.it
    redirect scheme https if host_c_lecco !{ ssl_fc }
    use_backend  mweb03_lecco_compilazione  if  host_c_lecco

    acl host_f_sicilia  hdr(host)  -i fad.izssicilia.it
    redirect scheme https if host_f_sicilia !{ ssl_fc }
    use_backend  mweb03_sicilia  if  host_f_sicilia

    acl host_f_polis  hdr(host)  -i fad.polis.lombardia.it
    redirect scheme https if host_f_polis !{ ssl_fc }
    use_backend  mweb03_polis  if  host_f_polis

    acl host_f_accademia_polis  hdr(host)  -i fad.accademia.polis.lombardia.it
    redirect scheme https if host_f_accademia_polis !{ ssl_fc }
    use_backend  mweb03_polis_accademia  if  host_f_accademia_polis

    acl host_f_polis_valutazioneweb  hdr(host)  -i valutazioneweb.accademia.polis.lombardia.it
    redirect scheme https if host_f_polis_valutazioneweb !{ ssl_fc }
    use_backend  mweb03_polis_valutazione_web_accademia  if  host_f_polis_valutazioneweb

    acl host_f_franciacorta  hdr(host)  -i asst-franciacorta.formazionesanitaria.it
    redirect scheme https if host_f_franciacorta !{ ssl_fc }
    use_backend  mweb03_franciacorta  if  host_f_franciacorta

    acl host_f_garda  hdr(host)  -i asst-garda.formazionesanitaria.it
    redirect scheme https if host_f_garda !{ ssl_fc }
    use_backend  mweb04_garda  if  host_f_garda

    acl host_f_ovestmi  hdr(host)  -i  fad.asst-ovestmi.it
    redirect scheme https if host_f_ovestmi !{ ssl_fc }
    use_backend  mweb03_ovestmi  if  host_f_ovestmi

    acl host_f_valleolona  hdr(host)  -i  fad.asst-valleolona.it
    redirect scheme https if host_f_valleolona !{ ssl_fc }
    use_backend  mweb03_valleolona  if  host_f_valleolona

    acl host_f_nordmilano  hdr(host)  -i fad.asst-nordmilano.it
    redirect scheme https if host_f_nordmilano !{ ssl_fc }
    use_backend  mweb04_nordmilano  if  host_f_nordmilano

    acl host_f_besta  hdr(host)  -i fad.istituto-besta.it
    redirect scheme https if host_f_besta !{ ssl_fc }
    use_backend  mweb04_besta  if  host_f_besta

    acl host_f_corsi  hdr(host)  -i corsi.formazionesanitaria.it
    redirect scheme https if host_f_corsi !{ ssl_fc }
    use_backend  mweb04_ivfcorsi  if  host_f_corsi
    
    acl host_f_bergamoest  hdr(host)  -i asst-bergamoest.formazionesanitaria.it
    redirect scheme https if host_f_bergamoest !{ ssl_fc }
    use_backend  mweb04_bergamoest  if  host_f_bergamoest

    acl host_f_santipaolocarlo  hdr(host)  -i asst-santipaolocarlo.formazionesanitaria.it
    redirect scheme https if host_f_santipaolocarlo !{ ssl_fc }
    use_backend  mweb04_santipaolocarlo  if  host_f_santipaolocarlo
   
    acl host_f_sciotwavecorsi  hdr(host)  -i corsi.sciotwave.it
    redirect scheme https if host_f_sciotwavecorsi !{ ssl_fc }
    use_backend  mweb04_sciotwavecorsi  if  host_f_sciotwavecorsi
   
    acl host_f_valcamonica  hdr(host)  -i fad.asst-valcamonica.it
    redirect scheme https if host_f_valcamonica !{ ssl_fc }
    use_backend  mweb04_valcamonica  if  host_f_valcamonica
   
    acl host_f_valtellina  hdr(host)  -i asst-val.formazionesanitaria.it
    redirect scheme https if host_f_valtellina !{ ssl_fc }
    use_backend  mweb04_valtellina  if  host_f_valtellina

    acl host_f_ivffad  hdr(host)  -i fad.invisiblefarm.it
    redirect scheme https if host_f_ivffad !{ ssl_fc }
    use_backend  mweb04_ivffad  if  host_f_ivffad

    acl host_f_rhodense  hdr(host)  -i fad.asst-rhodense.it
    redirect scheme https if host_f_rhodense !{ ssl_fc }
    use_backend  mweb04_rhodense  if  host_f_rhodense

    acl host_f_valpadana  hdr(host)  -i fad.ats-valpadana.it
    redirect scheme https if host_f_valpadana !{ ssl_fc }
    use_backend  mweb04_valpadana  if  host_f_valpadana

    acl host_covid_hub  hdr(host)  -i covid19-hub2.invisiblefarm.it
    redirect scheme https if host_covid_hub !{ ssl_fc }
    use_backend  covid_hub  if  host_covid_hub

    acl host_prenotazione_campioni  hdr(host)  -i prenotazione-campioni.invisiblefarm.it
    redirect scheme https if host_prenotazione_campioni !{ ssl_fc }
    use_backend  prenotazione_campioni  if  host_prenotazione_campioni

    acl host_prenotazione_campioni_izslt_test  hdr(host)  -i prenotazione-campioni-izslt.invisiblefarm.it
    redirect scheme https if host_prenotazione_campioni_izslt_test !{ ssl_fc }
    use_backend  prenotazione_campioni_izslt_test  if  host_prenotazione_campioni_izslt_test


    acl host_prenotazione_campioni_dev  hdr(host)  -i prenotazione-campioni-dev.invisiblefarm.it
    #redirect scheme https if host_prenotazione_campioni_dev !{ ssl_fc }
    use_backend  prenotazione_campioni_dev  if  host_prenotazione_campioni_dev

    acl host_docker18_api_sigla hdr(host) -i api-sigla.invisiblefarm.it
    redirect scheme https if host_docker18_api_sigla !{ ssl_fc }
    use_backend docker18_api_sigla if host_docker18_api_sigla

    acl host_docker18_signerhub_test hdr(host) -i invisiblesign-test.invisiblefarm.it
    redirect scheme https if host_docker18_signerhub_test !{ ssl_fc }
    use_backend docker18_signerhub_test if host_docker18_signerhub_test

    acl host_estopper  hdr(host)  -i www.estopper.it
    redirect scheme https if host_estopper !{ ssl_fc }
    use_backend  estopper  if  host_estopper

    acl host_ibeaitalia hdr(host) -i www.ibeaitalia.it
    redirect scheme https if host_ibeaitalia !{ ssl_fc }
    use_backend docker16_ibeaitalia if host_ibeaitalia

    acl host_citybadge hdr(host) -i citybadge.it
    redirect scheme https if host_citybadge !{ ssl_fc }
    use_backend docker16_citybadge if host_citybadge

    acl host_citybadge_www hdr(host) -i www.citybadge.it
    redirect scheme https if host_citybadge_www !{ ssl_fc }
    use_backend docker16_citybadge if host_citybadge_www

    acl host_portalesindaci hdr(host) -i portalesindaci.invisiblefarm.it
    redirect scheme https if host_portalesindaci !{ ssl_fc }
    use_backend docker16_portalesindaci if host_portalesindaci

    acl host_c_valtellina  hdr(host)  -i compila-val.formazionesanitaria.it
    redirect scheme https if host_c_valtellina !{ ssl_fc }
    use_backend  mweb04_valtellina_compilazione  if  host_c_valtellina
    default_backend     mweb01

    acl host_signer_hub  hdr(host)  -i signerhub.invisiblefarm.it
    redirect scheme https if host_signer_hub !{ ssl_fc }
    use_backend  signer_hub  if  host_signer_hub

    acl host_test_ivf  hdr(host)  -i test.invisiblefarm.it
    acl host_test_ivf_sivian path_beg -i /sivian
    acl host_test_ivf_sentinelfarm_api path_beg -i /serverfarm/api
    redirect scheme https if host_test_ivf !{ ssl_fc }
    use_backend docker12 if host_test_ivf
#    use_backend  docker12_test_ivf  if  host_test_ivf !host_test_ivf_sivian !host_test_ivf_sentinelfarm_api
#    use_backend  docker12_test_ivf_sivian if  host_test_ivf host_test_ivf_sivian
#    use_backend  docker12_test_ivf_sentinelfarm_api if host_test_ivf host_test_ivf_sentinelfarm_api

    acl host_nso  hdr(host)  -i nso.invisiblefarm.it
    redirect scheme https if host_nso !{ ssl_fc }
    use_backend  docker09_nso  if  host_nso

    acl host_www_sosscuole_it  hdr(host)  -i www.sosscuole.it
#    redirect scheme https if host_www_sosscuole_it !{ ssl_fc }
    use_backend  docker09_sosscuole  if  host_www_sosscuole_it

    acl host_test_sosscuole_it  hdr(host)  -i test.sosscuole.it
    redirect scheme https if host_test_sosscuole_it !{ ssl_fc }
    use_backend  docker12_sosscuole  if  host_test_sosscuole_it
    
    acl host_test_acquebresciane  hdr(host)  -i acquebresciane.invisiblefarm.it
    redirect scheme https if host_test_acquebresciane !{ ssl_fc }
    use_backend  docker12_acquebresciane  if  host_test_acquebresciane
   
    acl host_test_infopass  hdr(host)  -i test-infopass.skipasslombardia.it
    redirect scheme https if host_test_infopass !{ ssl_fc }
    use_backend  docker12_infopass  if  host_test_infopass
    
    acl host_prod_infopass  hdr(host)  -i infopass.skipasslombardia.it
    redirect scheme https if host_prod_infopass !{ ssl_fc }
    use_backend  docker24_infopass  if  host_prod_infopass
    

    acl host_test_asma hdr(host) -i test-asma.invisiblefarm.it
    redirect scheme https if host_test_asma !{ ssl_fc }
    use_backend docker12_asma if host_test_asma 

    acl host_test_asma_alternativo hdr(host) -i testasma.invisiblefarm.it
    redirect scheme https if host_test_asma_alternativo !{ ssl_fc }
    use_backend docker12_asma if host_test_asma_alternativo 
 
    acl host_test_cup  hdr(host)  -i cup-test.invisiblefarm.it
    redirect scheme https if host_test_cup !{ ssl_fc }
    use_backend  docker12_test_cup  if  host_test_cup
    
    acl host_docker12_cdg_test hdr(host) -i test-cdg.invisiblefarm.it
    redirect scheme https if host_docker12_cdg_test !{ ssl_fc }
    use_backend  docker12_cdg_test if host_docker12_cdg_test    

    acl host_prod_cup  hdr(host)  -i cupvet.ats-insubria.it
    redirect scheme https if host_prod_cup !{ ssl_fc }
    use_backend  docker24_cup  if  host_prod_cup

    acl host_prod_redcap  hdr(host)  -i redcap.irccs-sangerardo.it
    redirect scheme https if host_prod_redcap !{ ssl_fc }
    use_backend  docker24_redcap  if  host_prod_redcap


    acl host_test_poste  hdr(host)  -i posthub-test.invisiblefarm.it
    redirect scheme https if host_test_poste !{ ssl_fc }
    use_backend  docker12_test_poste  if  host_test_poste
    
    acl host_prod_poste  hdr(host)  -i posthub.invisiblefarm.it
    redirect scheme https if host_prod_poste !{ ssl_fc }
    use_backend  docker24_prod_poste  if  host_prod_poste

    acl host_git  hdr(host)  -i git.invisiblefarm.it
    redirect scheme https if host_git !{ ssl_fc }
    use_backend  docker13_git  if  host_git

    acl host_wiki  hdr(host)  -i wiki.invisiblefarm.it
    redirect scheme https if host_wiki !{ ssl_fc }
    use_backend  docker13_wiki  if  host_wiki

    acl host_ws_scontrolli2  hdr(host)  -i swcontrolli-api.invisiblefarm.it
    redirect scheme https if host_ws_scontrolli2 !{ ssl_fc }
    use_backend  docker09_ws_scontrolli2  if  host_ws_scontrolli2

    acl host_test_sentinelfarm_it  hdr(host)  -i sentinelfarm-test.invisiblefarm.it
    redirect scheme https if host_test_sentinelfarm_it !{ ssl_fc }
    use_backend  docker12_test_sentinelfarm_it  if  host_test_sentinelfarm_it

    acl host_docs_invisiblefarm_it  hdr(host)  -i docs.invisiblefarm.it
    redirect scheme https if host_docs_invisiblefarm_it !{ ssl_fc }
    use_backend  docker13_docs_invisiblefarm_it  if  host_docs_invisiblefarm_it

    acl host_api_iot_test_invisiblefarm_it  hdr(host)  -i api-iot-test.invisiblefarm.it
    redirect scheme https if host_api_iot_test_invisiblefarm_it !{ ssl_fc }
    use_backend  docker12_api_iot_test_invisiblefarm_it  if  host_api_iot_test_invisiblefarm_it
     
    acl host_docker14_smi_test hdr(host)  -i smi-test.invisiblefarm.it
    redirect scheme https if host_docker14_smi_test !{ ssl_fc }
    use_backend docker14_smi_test if host_docker14_smi_test
    
    acl host_covid_mnt_test  hdr(host)  -i test-covid-montagna.invisiblefarm.it
    acl host_covid_mnt_test_rds path_beg -i /portalescuole
    redirect scheme https if host_covid_mnt_test !{ ssl_fc }
    use_backend  docker14_covid_mnt_test  if  host_covid_mnt_test !host_covid_mnt_test_rds

    acl host_covid_pv_test  hdr(host)  -i test-covid-pavia.invisiblefarm.it
    acl host_covid_pv_test_rds path_beg -i /portalescuole
    redirect scheme https if host_covid_pv_test !{ ssl_fc }
    use_backend  docker14_covid_pv_test  if  host_covid_pv_test !host_covid_pv_test_rds

    acl host_api_test_ankio  hdr(host)  -i test-ankio.invisiblefarm.it
    redirect scheme https if host_api_test_ankio !{ ssl_fc }
    use_backend  docker12_api_test_ankio  if  host_api_test_ankio
    
    acl host_sivian_utility_test hdr(host) -i utility-test.invisiblefarm.it
    redirect scheme https if host_sivian_utility_test !{ ssl_fc }
    use_backend docker12_sivian_utility if host_sivian_utility_test
   
    acl host_sivian_utility_prod hdr(host) -i utility.sivian.it
    redirect scheme https if host_sivian_utility_prod !{ ssl_fc }
    use_backend docker02_sivian_utility_prod if host_sivian_utility_prod
 
    acl host_test_memo  hdr(host)  -i memo-test.invisiblefarm.it
    redirect scheme https if host_test_memo !{ ssl_fc }
    use_backend  docker12_test_memo  if  host_test_memo

    acl host_test_sso  hdr(host)  -i sso-test.invisiblefarm.it
    redirect scheme https if host_test_sso !{ ssl_fc }
    use_backend  docker12_test_sso  if  host_test_sso

    acl host_pg32_demo hdr(host) -i demoappdipendentipg23.invisiblefarm.it
    redirect scheme https if host_pg32_demo !{ ssl_fc  }
    use_backend  docker15_pg23_demo if host_pg32_demo

    acl host_pg23_demo_test hdr(host) -i testappdipendentipg23.invisiblefarm.it
    redirect scheme https if host_pg23_demo_test !{ ssl_fc }
    use_backend  docker15_pg23_demo_test if host_pg23_demo_test

    acl host_office_converter  hdr(host)  -i officeconverter.invisiblefarm.it
    redirect scheme https if host_office_converter !{ ssl_fc }
    use_backend  docker12_office_converter  if  host_office_converter

    acl host_www_scr  hdr(host)  -i www.smartcityreadinesstool.it
    redirect scheme https if host_www_scr !{ ssl_fc }
    use_backend  docker01_scr if  host_www_scr

    acl host_scr  hdr(host)  -i smartcityreadinesstool.it
    redirect scheme https if host_scr !{ ssl_fc }
    use_backend  docker01_scr if  host_scr

    acl host_www_test_ivf  hdr(host)  -i www-test.invisiblefarm.it
    redirect scheme https if host_www_test_ivf !{ ssl_fc }
    use_backend  docker16_www_test_ivf if  host_www_test_ivf

    acl host_www_ivf  hdr(host)  -i www.invisiblefarm.it
    redirect scheme https if host_www_ivf !{ ssl_fc }
    use_backend  docker16_www_ivf if  host_www_ivf

    acl is_invisiblefarm hdr(host) -i invisiblefarm.com invisiblefarm.eu www.invisiblefarm.eu www.invisiblefarm.com
    http-request redirect code 301 location https://www.invisiblefarm.it if is_invisiblefarm

    acl host_formazione_sciotwave  hdr(host)  -i formazione.sciotwave.it
    redirect scheme https if host_formazione_sciotwave !{ ssl_fc }
    use_backend  docker16_formazione_sciotwave if  host_formazione_sciotwave
    
    acl host_progetti_ivf hdr(host) -i progetti.invisiblefarm.it
    redirect scheme https if host_progetti_ivf !{ ssl_fc }
    use_backend  docker16_progetti  if  host_progetti_ivf 
    
    acl host_docker16_wiki hdr(host) -i sigla-wiki.invisiblefarm.it
    redirect scheme https if host_docker16_wiki !{ ssl_fc }
    use_backend  docker16_wiki  if  host_docker16_wiki 
    

    acl host_win02_formazione_admin hdr(host) -i formadmin.izslt.it
    redirect scheme https if host_win02_formazione_admin !{ ssl_fc }
    use_backend win02_formazione_admin if host_win02_formazione_admin   

    acl host_win02_formazione_admin_sicilia hdr(host) -i formadmin.izssicilia.it
    redirect scheme https if host_win02_formazione_admin_sicilia !{ ssl_fc }
    use_backend win02_formazione_admin if host_win02_formazione_admin_sicilia

    acl host_win02_formazione_sicilia hdr(host) -i formazione.izssicilia.it
    redirect scheme https if host_win02_formazione_sicilia !{ ssl_fc }
    use_backend win02_formazione if host_win02_formazione_sicilia
   
    acl host_win02_formazione_admin_portici hdr(host) -i formadmin.izsmportici.it
    redirect scheme https if host_win02_formazione_admin_portici !{ ssl_fc }
    use_backend win02_formazione_admin if host_win02_formazione_admin_portici

    acl host_win02_formazione_portici hdr(host) -i formazione.izsmportici.it 
    redirect scheme https if host_win02_formazione_portici !{ ssl_fc }
    use_backend win02_formazione if host_win02_formazione_portici   

    acl host_win02_formazione hdr(host) -i formazione.izslt.it
    redirect scheme https if host_win02_formazione !{ ssl_fc }
    use_backend win02_formazione if host_win02_formazione
   
    acl host_win02_formazione_sanitaria hdr(host) -i formazione.accademia.polis.lombardia.it
    redirect scheme https if host_win02_formazione_sanitaria !{ ssl_fc }
    use_backend win02_formazione if host_win02_formazione_sanitaria

    acl host_win02_formazione_sanitaria_gestform hdr(host) -i gestionale.formazione.accademia.polis.lombardia.it
    redirect scheme https if host_win02_formazione_sanitaria_gestform !{ ssl_fc }
    use_backend win02_formazione_admin if host_win02_formazione_sanitaria_gestform
    
    acl host_win02_gestform_izsum hdr(host) -i gestform.izsum.it
    redirect scheme https if host_win02_gestform_izsum !{ ssl_fc }
    use_backend win02_gestform_izsum if host_win02_gestform_izsum

    acl host_win02_formazione_izsum hdr(host) -i formazione.izsum.it
    redirect scheme https if host_win02_formazione_izsum !{ ssl_fc }
    use_backend win02_formazione_izsum if host_win02_formazione_izsum

    acl host_win02_gestform_lombardia hdr(host) -i gestioneformazione.polis.lombardia.it
    redirect scheme https if host_win02_gestform_lombardia !{ ssl_fc }
    use_backend win02_gestform_lombardia if host_win02_gestform_lombardia

    acl host_win02_formazione_lombardia hdr(host) -i formazione.polis.lombardia.it
    redirect scheme https if host_win02_formazione_lombardia !{ ssl_fc }
    use_backend win02_formazione_lombardia if host_win02_formazione_lombardia
    
    acl host_mweb01_compilazione_izsum hdr(host) -i compilazione.izsum.it
    redirect scheme https if host_mweb01_compilazione_izsum !{ ssl_fc }
    use_backend mweb01_compilazione_izsum if host_mweb01_compilazione_izsum  

    acl host_mweb01_compilazione_izssicilia hdr(host) -i compilazione.izssicilia.it
    redirect scheme https if host_mweb01_compilazione_izssicilia !{ ssl_fc }
    use_backend mweb01_compilazione_izssicilia if host_mweb01_compilazione_izssicilia  

    acl host_skipass_test hdr(host) -i test-skipass.invisiblefarm.it
    redirect scheme https if host_skipass_test !{ ssl_fc }
    use_backend docker15_skipass_test if host_skipass_test

    acl host_zentral  hdr(host)  -i zentral.invisiblefarm.it
    redirect scheme https if host_zentral !{ ssl_fc }
    use_backend  docker26 if  host_zentral

    acl host_survey  hdr(host)  -i survey.invisiblefarm.it

    use_backend  mweb03_survey  if  host_survey

#---------------------------------------------------------------------
# round robin balancing between the various backends
#---------------------------------------------------------------------

backend docker01_rmi
       mode        http
       balance     roundrobin
       option httpchk HEAD / HTTP/1.1\r\nHost:\ localhost
       server  docker01  192.168.5.32:8080  check inter 10m

backend docker12_rmi
       mode        http
       balance     roundrobin
       option tcp-check
       option forwardfor
       option http-server-close
       server  docker12  192.168.5.51:8090  check port 8090


backend docker17_botcommander
       mode        http
       balance     roundrobin
       option tcp-check
       server  docker17 192.168.5.58:18089  check port 18089

backend docker17_infobot
       mode        http
       balance     roundrobin
       option tcp-check
       server  docker17 192.168.5.58:18086  check port 18086


backend docker17_connectorfarm
       mode        http
       balance     roundrobin
       option tcp-check
       server  docker17 192.168.5.58:18088 check port 18088

backend docker17_sentinelfarm_web
       mode        http
       balance     roundrobin
       option      tcp-check
       server  docker17 192.168.5.58:9104 check port 9104

backend docker17_sentinelfarm_api
       mode        http
       balance     roundrobin
       option tcp-check
       server docker17 192.168.5.58:9101 check port 9101

backend docker17_apibdn
       mode       http
       balance    roundrobin
       option httpchk GET /
       server docker17 192.168.5.58:18087 check inter 10m

backend docker18_sigla4_izsler
       mode       http
       balance    roundrobin
       option tcp-check
       server docker18 192.168.5.59:8080 check port 8080

backend docker18_signerhub_test
       mode       http
       balance    roundrobin
       option tcp-check
       server docker18 192.168.5.59:3003 check port 3003

backend docker18_sigla5_izsler
       mode       http
       balance    roundrobin
       option tcp-check
       server docker18 192.168.5.80:7807 check port 7807

backend docker18_sigla_izsum
       mode       http
       balance    roundrobin
       option tcp-check
       server docker18 192.168.5.59:8082 check port 8082

backend docker19_api
       mode       http
       balance    roundrobin
       option tcp-check
       server docker19 192.168.5.61:9000 check port 9000

backend docker18_sigla_lab
       mode       http
       balance    roundrobin
       option tcp-check
       server docker18 192.168.5.59:8787 check port 8787

backend snowapp_azure_test
       mode http
       server snowapp_server tst-snowapp-erp-01-wa.azurewebsites.net:443 check ssl verify none

backend snowapp_azure_prod
       mode http
       server snowapp_server prd-snowapp-erp-01-wa.azurewebsites.net:443 check ssl verify none

backend snowapp_azure_web_test
       mode http
       server azure_server tst-snowapp-web-01-wa.azurewebsites.net:443 check ssl verify none

backend snowapp_azure_web_prod
       mode http
       server azure_server prd-snowapp-web-01-wa.azurewebsites.net:443 check ssl verify none

backend snowapp_azure_wa_test
       mode http
       server azure_server tst-snowapp-api-01-wa.azurewebsites.net:443 check ssl verify none

backend snowapp_azure_wa_prod
       mode http
       server azure_server prd-snowapp-api-01-wa.azurewebsites.net:443 check ssl verify none

backend docker19_acquebresciane
       mode       http
       balance    roundrobin
       option tcp-check
       server docker19 192.168.5.61:9002 check port 9002

backend docker19_cdg
       mode       http
       balance    roundrobin
       option tcp-check
       server docker19 192.168.5.61:8880 check port 8880

backend docker21_test_santionibus_antonio
       mode       http
       balance    roundrobin
       option  tcp-check
       server docker21 192.168.5.63:8082 check port 8082

backend docker23_santionibus
       mode       http
       balance    roundrobin
       option  tcp-check
       server docker23 192.168.5.66:8082 check port 8082


backend docker21_test_santionibus_milano
       mode       http
       balance    roundrobin
       option  tcp-check
       server docker21 192.168.5.63:8083 check port 8083

backend docker20_prod_santionibus_milano
       mode       http
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       balance    roundrobin
       option  tcp-check
       server docker20 192.168.5.62:8083 check port 8083


backend docker21_test_api_santionibus_milano
       mode       http
       balance    roundrobin
       option  tcp-check
       server docker21 192.168.5.63:8084 check port 8084

backend docker20_prod_api_santionibus_milano
       mode       http
       balance    roundrobin
       option  tcp-check
       server docker20 192.168.5.62:8084 check port 8084


backend docker21_test_billing
       mode       http
       balance    roundrobin
       option  tcp-check
       server docker21 192.168.5.63:8092 check port 8092

backend docker23_billing
       mode       http
       balance    roundrobin
       option  tcp-check
       server docker23 192.168.5.66:8092 check port 8092



backend docker20_devops
       mode       http
       balance    roundrobin
       option tcp-check
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       server docker12 192.168.5.51:9990 check port 9990

backend docker22_polis
       mode       http
       balance    roundrobin
       option tcp-check
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       server docker22 192.168.5.64:9101 check port 9101

backend docker22_polis_prod
       mode       http
       balance    roundrobin
       option tcp-check
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       server docker22 192.168.5.64:9103 check port 9103

backend docker01_signer_rmi
       mode        http
       balance     roundrobin
       option tcp-check
       server  docker01  192.168.5.32:8082  check port 8082

backend docker02_www_sivian_it
       mode        http
       balance     roundrobin
       option httpchk HEAD / HTTP/1.1\r\nHost:\ localhost
       server  docker02  192.168.5.33:80  check inter 10m

backend docker02_suite_sivian_it
       mode        http
       balance     roundrobin
       option tcp-check
       server  docker02  192.168.5.33:8085  check port 8085

backend podman02_suite_sivian_it
       mode        http
       balance     roundrobin
       option tcp-check
       server  podman02  192.168.5.71:8082  check port 8082

backend podman02_siv_sivian_it
       mode        http
       balance     roundrobin
       option tcp-check
       server  podman02  192.168.5.71:8089  check port 8089

backend podman02_sel_sivian_it
       mode        http
       balance     roundrobin
       option tcp-check
       server  podman02  192.168.5.71:8090  check port 8090

backend docker02_www_vetinweb_it
       mode        http
       balance     roundrobin
       option httpchk HEAD / HTTP/1.1\r\nHost:\ localhost
       server  docker02  192.168.5.33:80  check inter 10m

backend docker02_art316-mi
       mode        http
       balance     roundrobin
       option httpchk HEAD / HTTP/1.1\r\nHost:\ localhost
       server  docker02  192.168.5.33:80  check inter 10m

backend docker02_api-art316-mi
       mode        http
       balance     roundrobin
       option httpchk HEAD / HTTP/1.1\r\nHost:\ localhost
       server  docker02  192.168.5.33:80  check inter 10m

backend docker02_verbali_sivian_it
       mode        http
       balance     roundrobin
       option httpchk HEAD / HTTP/1.1\r\nHost:\ localhost
       server  docker02  192.168.5.33:80  check inter 10m

backend docker02_bg_sivian_it
       mode        http
       balance     roundrobin
       option httpchk HEAD / HTTP/1.1\r\nHost:\ localhost
       server  docker02  192.168.5.33:80  check inter 10m

backend docker02_bs_sivian_it
       mode        http
       balance     roundrobin
       option httpchk HEAD / HTTP/1.1\r\nHost:\ localhost
       server  docker02  192.168.5.33:80  check inter 10m

backend docker02_mb_sivian_it
       mode        http
       balance     roundrobin
       option httpchk HEAD / HTTP/1.1\r\nHost:\ localhost
       server  docker02  192.168.5.33:80  check inter 10m

backend podman02_mb_sivian_it
       mode        http
       balance     roundrobin
       option      tcp-check
       server  podman02  192.168.5.71:8080  check port 8080

backend podman02_mi_sivian_it
       mode        http
       balance     roundrobin
       option      tcp-check
       server  podman02  192.168.5.71:8084  check port 8084

backend podman02_va_sivian_it
       mode        http
       balance     roundrobin
       option      tcp-check
       server  podman02  192.168.5.71:8085  check port 8085

backend podman02_bs_sivian_it
       mode        http
       balance     roundrobin
       option      tcp-check
       server  podman02  192.168.5.71:8083  check port 8083

backend podman02_bg_sivian_it
       mode        http
       balance     roundrobin
       option      tcp-check
       server  podman02  192.168.5.71:8086  check port 8086

backend podman02_mo_sivian_it
       mode        http
       balance     roundrobin
       option      tcp-check
       server  podman02  192.168.5.71:8087  check port 8087

backend podman02_pv_sivian_it
       mode        http
       balance     roundrobin
       option      tcp-check
       server  podman02  192.168.5.71:8088  check port 8088

backend podman02_api_sivian_it
       mode        http
       balance     roundrobin
       option      tcp-check
       server  podman02  192.168.5.71:8081  check port 8081

backend docker02_mi_sivian_it
       mode        http
       balance     roundrobin
       option httpchk HEAD / HTTP/1.1\r\nHost:\ localhost
       server  docker02  192.168.5.33:80  check inter 10m

backend docker02_va_sivian_it
       mode        http
       balance     roundrobin
       option httpchk HEAD / HTTP/1.1\r\nHost:\ localhost
       server  docker02  192.168.5.33:80  check inter 10m

backend docker01_ws_sosscuole
       mode        http
       balance     roundrobin
       option httpchk GET /
       server  docker01  192.168.5.32:80  check inter 10m

backend docker01_cruscotto_sosscuole
       mode        http
       balance     roundrobin
       option httpchk HEAD / HTTP/1.1\r\nHost:\ localhost
       server  docker01  192.168.5.32:5000  check inter 15m

backend docker01_ws_pay_hub
       mode        http
       balance     roundrobin
       option httpchk GET /swagger
       server  docker01  192.168.5.32:5010  check inter 10m
       server  docker01  192.168.5.32:5012  check inter 10m

backend mweb02_cremona
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb02  192.168.5.38:8081  check inter 10m

backend mweb02_cremona_compilazione
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb02  192.168.5.38:8092  check port 8092


backend mweb02_mantova
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb02  192.168.5.38:8082  check inter 10m

backend mweb01_mantova
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb01  192.168.5.30:8093  check inter 10m

backend mweb01_mantova_compilazione
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb01  192.168.5.30:8089  check port 8089

backend mweb01_fad
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb01  192.168.5.30:8095  check port 8095

backend mweb01_test_bergamoest
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb01  192.168.5.30:8097  check port 8097

backend mweb01_test2_formazionesanitaria
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb01  192.168.5.30:8096  check port 8096

backend mweb02_fondazionebssolidale
       mode        http
       balance     roundrobin
       option tcp-check
       server  mweb02 192.168.5.38:8085 check port 8085

backend mweb04_gestione_aule_sangerardo
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }  
       option  tcp-check
       server  mweb04  192.168.5.44:8099  check port 8099     

backend mweb02_sette_laghi
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb02  192.168.5.38:8084  check port 8084

backend mweb02_izsler
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb02  192.168.5.38:8083  check port 8083

backend mweb04_sanmatteo
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb04  192.168.5.44:8092  check inter 10m

backend mweb03_portici
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb03  192.168.5.42:8081  check inter 10m

backend mweb03_portici_compilazione
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb03  192.168.5.42:8087  check port 8087

backend mweb03_sicilia
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb03  192.168.5.42:8083  check inter 10m

backend mweb03_polis
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb03  192.168.5.42:8090  check port 8090

backend mweb03_polis_accademia
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb03  192.168.5.42:8091  check port 8091


backend mweb03_polis_valutazione_web_accademia
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb03  192.168.5.42:8086  check port 8086


backend mweb03_franciacorta
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb03  192.168.5.42:8085  check inter 10m

backend mweb03_lecco
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb03  192.168.5.42:8084  check port 8084

backend mweb03_lecco_compilazione
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb03  192.168.5.42:8082  check port 8082

backend mweb04_garda
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb04  192.168.5.44:8091  check inter 10m

backend mweb04_sangerardo
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb04 192.168.5.44:8097  check port 8097

backend mweb04_compilazione_izslt
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb04  192.168.5.44:8094  check inter 5m
backend mweb03_ovestmi
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb03  192.168.5.42:8088  check port 8088

backend mweb03_valleolona
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb03  192.168.5.42:8089  check inter 5m

backend mweb03_survey
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb03  192.168.5.42:8091  check inter 5m

backend mweb04_nordmilano
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
      server  mweb04  192.168.5.44:8081  check inter 10m
  
backend mweb04_besta
       mode        http
      balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
      server  mweb04  192.168.5.44:8082  check inter 10m

backend mweb04_ivfcorsi
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb04  192.168.5.44:8083  check port 8083

backend mweb04_bergamoest
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
      option httpchk GET /
       server  mweb04  192.168.5.44:8084  check inter 10m

backend mweb04_valcamonica
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb04  192.168.5.44:8085  check inter 10m

backend mweb04_santipaolocarlo
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb04  192.168.5.44:8086  check inter 10m

backend mweb04_sciotwavecorsi
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb04  192.168.5.44:8087  check inter 10m

backend mweb04_valtellina
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb04  192.168.5.44:8088  check inter 10m

backend mweb04_valtellina_compilazione
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  mweb04  192.168.5.44:8080  check port 8080


backend mweb04_ivffad
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb04  192.168.5.44:8089  check inter 10m
        backend mweb04_rhodense
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb04  192.168.5.44:8093  check inter 10m
backend mweb04_valpadana
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  mweb04  192.168.5.44:8090  check inter 10m

backend covid_hub
       mode        http
       balance     roundrobin
       option httpchk GET /api/hub/info
       server  docker01  192.168.5.55:9101  check inter 10m

backend mweb03_mmg_test
       mode        http
       balance     roundrobin
       option httpchk GET /
       server  mweb03  192.168.5.42:9101  check inter 10m

backend mweb03_mmg_test_api
       mode        http
       balance     roundrobin
       option httpchk GET /swagger
       server  mweb03  192.168.5.42:9102  check inter 10m

backend letsencrypt-standalone
       server certbot 127.0.0.1:33080

backend mweb01
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /       
       server mweb01   192.168.5.30:80   check inter 10m

backend mweb01_test_formazione
       mode       http
       balance    roundrobin
       option tcp-check
       server mweb01 192.168.5.30:8094   check port 8094

backend mwebtest_test_formazione
       mode       http
       balance    roundrobin
       option tcp-check
       server mwebtest 192.168.5.73:8081   check port 8081


backend mweb01_old_apsstn
       mode       http
       balance    roundrobin
       option tcp-check
       server mweb01   192.168.5.30:8090   check port 8090

backend mweb01_apsstn
       mode       http
       balance    roundrobin
       option tcp-check
       server mweb01   192.168.5.30:8094   check port 8094


backend mweb01_dad_apsstn
       mode       http
       balance    roundrobin
       option tcp-check
       server mweb01   192.168.5.30:8092   check port 8092

backend mweb01_apsstn_formazioneindividuale
       mode       http
       balance    roundrobin
       option tcp-check
       server mweb01   192.168.5.30:8091   check port 8091


backend docker09_phpAdmin
       mode        http
       balance     roundrobin
       option httpchk GET /
       server win01   192.168.5.48:8080   check inter 10m

backend prenotazione_campioni
       mode        http
       balance     roundrobin
       option httpchk GET /
       server  docker08  192.168.5.51:8086  check inter 5m

backend prenotazione_campioni_dev
       mode        http
       balance     roundrobin
       option httpchk GET /
       server  docker08  192.168.5.54:80  check inter 5m

backend prenotazione_campioni_izslt_test
       mode        http
       balance     roundrobin
       option      tcp-check
       server  docker28  192.168.5.81:8080  check port 8080


backend estopper
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  docker09  192.168.5.48:8081  check inter 5m

backend docker16_ibeaitalia
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  docker16  192.168.5.57:8084  check inter 5m

backend docker18_api_sigla
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc } 
       option tcp-check
       server  docker18  192.168.5.59:9090 check port 9090

backend docker16_citybadge
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server docker16 192.168.5.57:8085 check inter 5m

backend docker16_portalesindaci
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server docker16 192.168.5.57:8086 check port 8086

backend docker09_sosscuole
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  docker09  192.168.5.48:8083  check inter 5m

backend docker12_infopass
       mode        http
       balance     roundrobin
       option      tcp-check
       server      docker12 192.168.5.51:3535 check port 3535

backend docker24_infopass
       mode        http
       balance     roundrobin
       option      tcp-check
       server      docker24 192.168.5.68:3535 check port 3535

backend docker24_pinfoa_test
       mode        http
       balance     roundrobin
       option      tcp-check
       server      docker24 192.168.5.68:8081 check port 8081

backend docker12_sosscuole
       mode        http
       balance     roundrobin
#       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option httpchk GET /
       server  docker12  192.168.5.51:8083  check inter 5m
backend docker12_acquebresciane
       mode       http
       balance    roundrobin
       option     tcp-check
       server     docker12  192.168.5.51:9002 check port 9002

backend docker12_asma
       mode       http
       balance    roundrobin
       option     tcp-check
       server     docker12  192.168.5.51:8186 check port 8186

backend docker12_test_cup
       mode       http
       balance    roundrobin
       option     tcp-check
       server  docker12  192.168.5.51:3039 check port 3039
backend docker12_cdg_test
       mode       http
       balance    roundrobin
       option     tcp-check
       server  docker12  192.168.5.51:8880 check port 8880
backend docker24_cup
       mode       http
       balance    roundrobin
       option     tcp-check
       server  docker24  192.168.5.68:3039 check port 3039

backend docker24_redcap
       mode       http
       balance    roundrobin
       option     tcp-check
       server  docker24  192.168.5.68:9100 check port 9100

backend docker12_test_poste
       mode       http
       balance    roundrobin
       option     tcp-check
       server  docker12  192.168.5.51:3030 check port 3030

backend docker24_prod_poste
       mode       http
       balance    roundrobin
       option     tcp-check
       server  docker24  192.168.5.68:3030 check port 3030


backend signer_hub
       mode        http
       balance     roundrobin
       option httpchk GET /info
       server  docker09  192.168.5.48:9000  check inter 5m
       server  docker09  192.168.5.48:9002  check inter 5m
backend docker12_test_ivf
       mode        http
       balance     roundrobin
       option httpchk GET /sivian
       server  docker12  192.168.5.51:8081  check inter 5m

backend docker12_test_ivf_sivian
       mode        http
       balance     roundrobin
       option httpchk GET /sivian
       server  docker12  192.168.5.51:8081  check inter 5m


backend docker12_test_ivf_sentinelfarm_api
       mode        http
       balance     roundrobin
       option httpchk GET /api/v1/allevamento/list
       server  docker12  192.168.5.51:9101  check inter 5m

backend docker12_test_sentinelfarm_it
       mode        http
       balance     roundrobin
       option httpchk GET /
       server  docker12  192.168.5.51:9104  check inter 5m

backend docker12
       mode        http
       balance     roundrobin
       option httpchk GET /
       server  docker12  192.168.5.51:80  check inter 5m

backend docker09_nso
       mode        http
       balance     roundrobin
       option httpchk GET /
       server  docker09  192.168.5.48:8082  check inter 15m

backend docker09_ws_scontrolli2
       mode        http
       balance     roundrobin
       option httpchk GET /version
       server  docker09  192.168.5.48:9001  check inter 15m

backend docker13_git
       mode        http
       balance     roundrobin
       option httpchk GET /
       server  docker13  192.168.5.52:80  check inter 15m

backend docker13_wiki
       mode        http
       balance     roundrobin
       option httpchk GET /
       server  docker13  192.168.5.52:9280  check inter 15m

backend docker13_docs_invisiblefarm_it
       mode        http
       balance     roundrobin
       option tcp-check
       server  docker13  192.168.5.52:9300  check port 9300

backend docker12_api_iot_test_invisiblefarm_it
       mode        http
       balance     roundrobin
       option httpchk GET /
       server  docker12  192.168.5.51:8181  check inter 15m

backend docker12_sivian_utility
       mode        http
       balance     roundrobin
       option tcp-check
       server  docker12  192.168.5.51:8084  check port 8084

backend docker02_sivian_utility_prod
       mode        http
       balance     roundrobin
       option httpchk GET /
       server docker02 192.168.5.33:8084 check inter 5m
backend docker12_api_test_ankio
       mode        http
       balance     roundrobin
       option httpchk GET /info
       server  docker12  192.168.5.51:9105  check inter 15m

backend docker12_test_memo
       mode        http
       balance     roundrobin
       option httpchk GET /
       server  docker12  192.168.5.51:8100  check inter 15m

backend docker12_test_sso
       mode        http
       balance     roundrobin
       option tcp-check
       server  docker12  192.168.5.51:9106  check port 9106

backend docker14_smi_test
       mode        http
       balance     roundrobin
       option      tcp-check
       server docker14 192.168.5.55:81 check port 81

backend docker14_covid_mnt_test
       mode        http
       balance     roundrobin
       option      tcp-check
       server  docker14  192.168.5.55:8080 check port 8080
           
backend docker14_covid_pv_test
       mode        http
       balance     roundrobin
       option      tcp-check
       server  docker14  192.168.5.55:8081  check port 8081
       #errorfile 503 /etc/haproxy/errors/503.http

backend docker15_pg23_demo
       mode        http
       balance     roundrobin
       option httpchk GET /
       server docker15 192.168.5.56:8089 check inter 5m

backend docker15_pg23_demo_test
       mode        http
       balance     roundrobin
       option httpchk GET /
       server docker15 192.168.5.56:8091 check inter 5m 

backend docker15_skipass_test
       mode        http
       balance     roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  docker15  192.168.5.56:8086  check port 8086

backend docker12_office_converter
       mode        http
       balance     roundrobin
       option tcp-check
       server  docker12  192.168.5.51:9110  check port 9110

backend docker01_scr
       mode        http
       balance     roundrobin
       option tcp-check
       server  docker01  192.168.5.32:8085  check port 8085

backend docker16_www_test_ivf
       mode        http
       balance     roundrobin
       option tcp-check
       server  docker16  192.168.5.57:8082  check port 8082

backend docker16_www_ivf
       mode        http
       balance     roundrobin
       option tcp-check
       server  docker16  192.168.5.57:8081  check port 8081

backend docker16_formazione_sciotwave
       mode        http
       balance     roundrobin
       option tcp-check
       server  docker16  192.168.5.57:8083  check port 8083

backend docker16_wiki
       mode       http
       balance    roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  docker16  192.168.5.57:9280  check port 9280


backend docker16_progetti
       mode       http
       balance    roundrobin
       http-request add-header X-Forwarded-Proto https if { ssl_fc }
       option tcp-check
       server  docker16  192.168.5.57:9180  check port 9180
backend win02_formazione_admin
       mode       http
       balance    roundrobin
       option tcp-check
       server  win02  192.168.5.60:80  check port 80

backend win02_formazione
       mode       http
       balance    roundrobin
       option tcp-check
       server  win02  192.168.5.60:8080  check port 8080

backend win02_gestform_izsum
       mode       http
       balance    roundrobin
       option tcp-check
       server  win02  192.168.5.60:80   check port 80

backend win02_formazione_izsum
       mode       http
       balance    roundrobin
       option tcp-check
       server  win02  192.168.5.60:8080   check port 8080

backend win02_gestform_lombardia
       mode       http
       balance    roundrobin
       option tcp-check
       server  win02  192.168.5.60:80   check port 80

backend win02_formazione_lombardia
       mode       http
       balance    roundrobin
       option tcp-check
       server  win02  192.168.5.60:8080   check port 8080


backend mweb01_compilazione_izsum
       mode       http
       balance    roundrobin
       option tcp-check
       server  mweb01  192.168.5.30:8098  check port 8098

backend mweb01_compilazione_izssicilia
       mode       http
       balance    roundrobin
       option tcp-check
       server  mweb01  192.168.5.30:8099  check port 8099

backend docker24_passbolt
       mode       http
       balance    roundrobin
       option tcp-check
       server  docker24  192.168.5.68:9200  check port 9200

backend docker24_samltest
       mode       http
       balance    roundrobin
       option tcp-check
       option forwardfor
       option http-server-close
       server  docker24  192.168.5.68:443  ssl verify none

backend docker24_samlprod
       mode       http
       balance    roundrobin
       option tcp-check
       option forwardfor
       option http-server-close
       server  docker24  192.168.5.68:444  ssl verify none

 backend docker26
       mode       http
       balance    roundrobin
       option tcp-check
       option forwardfor
       option http-server-close
       server  docker26  192.168.5.78:8085 check port 8085
